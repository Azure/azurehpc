# NHC Configuration File
#
# Lines are in the form "<hostmask>||<check>"
# Hostmask is a glob, /regexp/, or {noderange}
# Comments begin with '#'
#
# This file was automatically generated by nhc-genconf
# Fri Jan 14 21:17:09 UTC 2022
#

#######################################################################
###
### Filesystem checks
###
 * || check_fs_mount_rw -t "sysfs" -s "sysfs" -f "/sys"
 * || check_fs_mount_rw -t "proc" -s "proc" -f "/proc"
 * || check_fs_mount_rw -t "mqueue" -s "mqueue" -f "/dev/mqueue"
 * || check_fs_used /dev 90%
 * || check_fs_used / 90%
 * || check_fs_used /boot/efi 90%
 * || check_fs_used /mnt 90%
 * || check_fs_used /data 90%
 * || check_fs_used /sched 90%
 * || check_fs_used /shared 90%
 * || check_fs_used /mnt/resource_nvme 90%
 * || check_fs_iused /dev 98%
 * || check_fs_iused / 100%
 * || check_fs_iused /mnt 98%
 * || check_fs_iused /data 98%
 * || check_fs_iused /sched 100%
 * || check_fs_iused /shared 98%
 * || check_fs_iused /mnt/resource_nvme 98%

#######################################################################
###
### Hardware checks
###
 * || check_hw_cpuinfo 2 96 96
 * || check_hw_physmem 908198052kB 908198052kB 3%
 * || check_hw_swap 0kB 0kB 3%
 * || check_hw_eth lo
 * || check_hw_eth eth0
 * || check_hw_eth eth1
 * || check_hw_eth docker0

#######################################################################
###
### Process checks
###
 * || check_ps_loadavg 192

#######################################################################
####
#### GPU checks
####
 * || check_gpu_count 4
 * || check_gpu_xid
 * || check_nvsmi_healthmon
 * || check_gpu_persistence
 * || check_app_gpu_clocks
 * || check_gpu_clock_throttling
# Path and env var AZ_NHC_ROOT defined in container
* || check_nccl_allreduce 228.0 1 $AZ_NHC_ROOT/topofiles/ndv4-topo.xml 16G
 * || check_nccl_allreduce 25.0 10 $AZ_NHC_ROOT/topofiles/ndv4-topo.xml 500M
